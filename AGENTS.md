# MWhisper - Agent Context Document

> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-11
> **–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:** üü¢ –†–∞–±–æ—Ç–∞–µ—Ç (v13)
> **–¢–µ–∫—É—â–∏–π –±–∏–ª–¥:** Build: 2026-01-11-v13

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**MWhisper** ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–æ–π –¥–∏–∫—Ç–æ–≤–∫–∏ –¥–ª—è Mac M1/M2/M3, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ –º–æ–¥–µ–ª—å Parakeet-MLX (NVIDIA Parakeet-TDT-0.6B-v3) –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Ä–µ—á–∏ –≤ —Ç–µ–∫—Å—Ç.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —Ä–µ—á–∏ | ‚úÖ –ì–æ—Ç–æ–≤–æ | Parakeet-MLX –º–æ–¥–µ–ª—å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 25 —è–∑—ã–∫–æ–≤ |
| –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚åò‚áßD (Cmd+Shift+D) |
| –í—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | pbcopy + AppleScript keystroke |
| –°–º–µ–Ω–∞ –≥–æ—Ä—è—á–µ–π –∫–ª–∞–≤–∏—à–∏ | ‚úÖ –ì–æ—Ç–æ–≤–æ | –ß–µ—Ä–µ–∑ –º–µ–Ω—é "Change Hotkey..." |
| –ú–µ–Ω—é-–±–∞—Ä | ‚úÖ –ì–æ—Ç–æ–≤–æ | rumps-based menu bar app |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–æ–≤-–ø–∞—Ä–∞–∑–∏—Ç–æ–≤ | ‚úÖ –ì–æ—Ç–æ–≤–æ | "uh", "um" –∏ —Ç.–¥. |
| –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∫—Ç–æ–≤–æ–∫ | ‚úÖ –ì–æ—Ç–æ–≤–æ | –•—Ä–∞–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø–∏—Å–µ–π |
| –°–±–æ—Ä–∫–∞ .app bundle | ‚úÖ –ì–æ—Ç–æ–≤–æ | PyInstaller + MWhisper.spec |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
MWhisper/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (—Å debug log –≤ ~/Desktop/)
‚îú‚îÄ‚îÄ config.json             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ MWhisper.spec          # PyInstaller spec –¥–ª—è —Å–±–æ—Ä–∫–∏ .app
‚îú‚îÄ‚îÄ AGENTS.md              # –≠–¢–û –§–ê–ô–õ - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ README.md              # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app.py             # –ì–ª–∞–≤–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (MWhisperApp class)
‚îÇ   ‚îú‚îÄ‚îÄ audio_capture.py   # –ó–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (sounddevice)
‚îÇ   ‚îú‚îÄ‚îÄ transcriber.py     # –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (parakeet-mlx)
‚îÇ   ‚îú‚îÄ‚îÄ text_inserter.py   # –í—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ (pbcopy + AppleScript)
‚îÇ   ‚îú‚îÄ‚îÄ hotkeys.py         # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ö–æ—Ç–∫–µ–∏ (pynput) + capture_hotkey()
‚îÇ   ‚îú‚îÄ‚îÄ menu_bar.py        # –ú–µ–Ω—é-–±–∞—Ä (rumps)
‚îÇ   ‚îú‚îÄ‚îÄ filler_filter.py   # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–æ–≤-–ø–∞—Ä–∞–∑–∏—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ history.py         # –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∫—Ç–æ–≤–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ settings.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
‚îú‚îÄ‚îÄ assets/                # –ò–∫–æ–Ω–∫–∏ –¥–ª—è –º–µ–Ω—é-–±–∞—Ä–∞
‚îú‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ dist/
‚îÇ   ‚îî‚îÄ‚îÄ MWhisper.app       # –°–æ–±—Ä–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ venv/                  # Python virtual environment
```

---

## üîß –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2026-01-11)

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –í—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥)

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–∫—Å—Ç –Ω–µ –≤—Å—Ç–∞–≤–ª—è–ª—Å—è ‚Äî –≤ –±—É—Ñ–µ—Ä –ø–æ–ø–∞–¥–∞–ª —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç.

**–ü—Ä–∏—á–∏–Ω–∞:** `app.py` –≤—ã–∑—ã–≤–∞–ª `inserter.insert()`, –Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—ã–ª–∏ –≤ `inserter.insert_text()` ‚Äî —ç—Ç–æ **–¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–∞**!

**–†–µ—à–µ–Ω–∏–µ:** 
- `insert()` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `_insert_via_applescript()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `/usr/bin/pbcopy` –¥–ª—è clipboard (–Ω–µ AppleScript `set the clipboard`)
- AppleScript —Ç–æ–ª—å–∫–æ –¥–ª—è `keystroke "v"`

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: –°–º–µ–Ω–∞ –≥–æ—Ä—è—á–µ–π –∫–ª–∞–≤–∏—à–∏

- –ù–æ–≤—ã–π –ø—É–Ω–∫—Ç –º–µ–Ω—é "Change Hotkey..."
- `HotkeyManager.capture_hotkey()` ‚Äî –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ config.json, —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

### ‚úÖ –£–±—Ä–∞–Ω–æ: –ê–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ Input Monitoring

–ë–æ–ª—å—à–µ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç System Settings –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ. –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ hotkey listener –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è.

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (config.json)

```json
{
    "hotkey": "<cmd>+<shift>+d",      // –ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞ (pynput format)
    "microphone_id": null,             // null = –º–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    "language": "auto",                // auto-detection —è–∑—ã–∫–∞
    "filter_fillers": true,            // –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞-–ø–∞—Ä–∞–∑–∏—Ç—ã
    "history_size": 20,                // –†–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏
    "insertion_method": "keystroke"    // –ú–µ—Ç–æ–¥ –≤—Å—Ç–∞–≤–∫–∏
}
```

---

## üì¶ –¢—Ä–µ–±—É–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è macOS

| –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | –ó–∞—á–µ–º –Ω—É–∂–Ω–æ | –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å |
|------------|-------------|--------------|
| **Accessibility** | –í—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ | System Settings ‚Üí Privacy ‚Üí Accessibility |
| **Input Monitoring** | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ö–æ—Ç–∫–µ–∏ | System Settings ‚Üí Privacy ‚Üí Input Monitoring |
| **Microphone** | –ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–∞ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è |

---

## üîÑ Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ó–∞–ø—É—Å–∫ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤:
```bash
cd /Users/admin/Desktop/DevOps/MWhisper
source venv/bin/activate
python main.py
```

### –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pkill -9 MWhisper
rm -rf build dist
source venv/bin/activate
pyinstaller --clean --noconfirm MWhisper.spec
rm -rf /Applications/MWhisper.app
cp -R dist/MWhisper.app /Applications/
open /Applications/MWhisper.app
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
cat ~/Desktop/mwhisper_debug.log | tail -30
```

---

## üé§ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. **–ó–∞–ø—É—Å–∫** ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å Parakeet-MLX (~2-5 —Å–µ–∫)
2. **‚åò‚áßD** ‚Üí –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
3. **‚åò‚áßD** (–ø–æ–≤—Ç–æ—Ä–Ω–æ) ‚Üí –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–ø–∏—Å—å
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞** ‚Üí –ê—É–¥–∏–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä—É–µ—Ç—Å—è, —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è —Å–ª–æ–≤–∞-–ø–∞—Ä–∞–∑–∏—Ç—ã
5. **–í—Å—Ç–∞–≤–∫–∞** ‚Üí –¢–µ–∫—Å—Ç –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ pbcopy + Cmd+V

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### Code-switching (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤)
Parakeet-MLX **–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω** –¥–ª—è code-switching. –ï—Å–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç—å "–ü—Ä–∏–≤–µ—Ç, hello":
- –ü–æ–ª—É—á–∏—Ç—Å—è: "–ü—Ä–∏–≤–µ—Ç, —Ö–µ–ª–æ—É" (–≤—Å—ë –Ω–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü–µ)
- –î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω—É–∂–µ–Ω Whisper-MLX

### –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å
–ú–æ–¥–µ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 25 —è–∑—ã–∫–æ–≤, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ –æ–¥–Ω–æ–≥–æ —è–∑—ã–∫–∞ –∑–∞ —Ä–∞–∑.

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –±–∏–ª–¥–∞:
–ú–µ–Ω—é-–±–∞—Ä ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—É–Ω–∫—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä "Build: 2026-01-11-v13")

### –õ–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏:
```
üî• HOTKEY TRIGGERED: <cmd>+<shift>+d
üé§ Starting recording...
‚èπ Recording stopped
Processing X samples (Y.Zs)...
=== V10: insert() called ===
[STEP 1] Starting insertion for: ...
[STEP 4] pbcopy exit code: 0
[STEP 6] pbpaste result: '...'
[STEP 10] Insertion complete!
‚úì Text inserted successfully
```

---

## üìù –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Whisper-MLX –¥–ª—è code-switching
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤ SRT —Å—É–±—Ç–∏—Ç—Ä—ã
- [ ] –í—ã–±–æ—Ä –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ —á–µ—Ä–µ–∑ GUI
- [ ] –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- [ ] Push-to-talk —Ä–µ–∂–∏–º (—É–¥–µ—Ä–∂–∞–Ω–∏–µ –∫–ª–∞–≤–∏—à–∏)
