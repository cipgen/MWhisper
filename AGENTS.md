# MWhisper - Agent Context Document

> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-11
> **–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:** üü° –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (Accessibility permissions issue)

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**MWhisper** ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–æ–π –¥–∏–∫—Ç–æ–≤–∫–∏ –¥–ª—è Mac M1/M2/M3, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ –º–æ–¥–µ–ª—å Parakeet-MLX (NVIDIA Parakeet-TDT-0.6B-v3) –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Ä–µ—á–∏ –≤ —Ç–µ–∫—Å—Ç.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —Ä–µ—á–∏ | ‚úÖ –ì–æ—Ç–æ–≤–æ | Parakeet-MLX –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | Ctrl+Option+R (—Ç—Ä–µ–±—É–µ—Ç Accessibility) |
| –í—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | –¢—Ä–µ–±—É–µ—Ç Accessibility permission |
| –ú–µ–Ω—é-–±–∞—Ä | ‚úÖ –ì–æ—Ç–æ–≤–æ | rumps-based menu bar app |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–æ–≤-–ø–∞—Ä–∞–∑–∏—Ç–æ–≤ | ‚úÖ –ì–æ—Ç–æ–≤–æ | "uh", "um" –∏ —Ç.–¥. |
| –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∫—Ç–æ–≤–æ–∫ | ‚úÖ –ì–æ—Ç–æ–≤–æ | –•—Ä–∞–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø–∏—Å–µ–π |
| –°–±–æ—Ä–∫–∞ .app bundle | ‚úÖ –ì–æ—Ç–æ–≤–æ | PyInstaller + MWhisper.spec |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
MWhisper/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config.json             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ MWhisper.spec          # PyInstaller spec –¥–ª—è —Å–±–æ—Ä–∫–∏ .app
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app.py             # –ì–ª–∞–≤–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (MWhisperApp class)
‚îÇ   ‚îú‚îÄ‚îÄ audio_capture.py   # –ó–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (sounddevice)
‚îÇ   ‚îú‚îÄ‚îÄ transcriber.py     # –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (parakeet-mlx)
‚îÇ   ‚îú‚îÄ‚îÄ text_inserter.py   # –í—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ (pyobjc/keystroke)
‚îÇ   ‚îú‚îÄ‚îÄ hotkeys.py         # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ö–æ—Ç–∫–µ–∏ (pynput)
‚îÇ   ‚îú‚îÄ‚îÄ menu_bar.py        # –ú–µ–Ω—é-–±–∞—Ä (rumps)
‚îÇ   ‚îú‚îÄ‚îÄ filler_filter.py   # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–æ–≤-–ø–∞—Ä–∞–∑–∏—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ history.py         # –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∫—Ç–æ–≤–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ settings.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
‚îú‚îÄ‚îÄ dist/
‚îÇ   ‚îî‚îÄ‚îÄ MWhisper.app       # –°–æ–±—Ä–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ venv/                  # Python virtual environment
```

---

## üîß –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùó –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: Accessibility Permissions

–î–ª—è —Ä–∞–±–æ—Ç—ã –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à –∏ –≤—Å—Ç–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ Accessibility –≤ macOS.

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ Accessibility:**
1. **Terminal.app** ‚Äî `/Applications/Utilities/Terminal.app`
2. **Python** ‚Äî `/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/bin/python3.14`
3. **MWhisper.app** ‚Äî `/Users/admin/Desktop/DevOps/MWhisper/dist/MWhisper.app`

**–°–∏–º–ø—Ç–æ–º—ã –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:**
- `pynput` –≤—ã–¥–∞—ë—Ç: "This process is not trusted!"
- –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç
- –¢–µ–∫—Å—Ç –Ω–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É:
```bash
cd /Users/admin/Desktop/DevOps/MWhisper
source venv/bin/activate
python main.py
```

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- "‚úì Accessibility permission granted"
- –ò–∫–æ–Ω–∫–∞ –≤ –º–µ–Ω—é-–±–∞—Ä–µ
- Ctrl+Option+R –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å –∑–∞–ø–∏—Å—å

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (config.json)

```json
{
    "hotkey": "<ctrl>+<alt>+r",      // –ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞
    "microphone_id": null,           // null = –º–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    "language": "auto",              // auto-detection —è–∑—ã–∫–∞
    "filter_fillers": true,          // –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞-–ø–∞—Ä–∞–∑–∏—Ç—ã
    "history_size": 20,              // –†–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏
    "auto_start": false,             // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
    "show_realtime_text": false      // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
}
```

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
parakeet-mlx>=0.1.0       # –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞)
sounddevice>=0.4.6        # –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ
numpy>=1.24.0             # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ
pynput>=1.7.6             # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ö–æ—Ç–∫–µ–∏
rumps>=0.4.0              # –ú–µ–Ω—é-–±–∞—Ä
pyperclip>=1.8.2          # –ë—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
pyobjc-framework-Cocoa>=9.0  # macOS APIs
```

---

## üîÑ Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ó–∞–ø—É—Å–∫ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤:
```bash
cd /Users/admin/Desktop/DevOps/MWhisper
source venv/bin/activate
python main.py
```

### –°–±–æ—Ä–∫–∞ .app bundle:
```bash
source venv/bin/activate
pyinstaller --clean --noconfirm MWhisper.spec
# –†–µ–∑—É–ª—å—Ç–∞—Ç: dist/MWhisper.app
```

### –ó–∞–ø—É—Å–∫ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
open dist/MWhisper.app
```

---

## üé§ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. **–ó–∞–ø—É—Å–∫** ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å Parakeet-MLX (~2-5 —Å–µ–∫)
2. **Ctrl+Option+R** ‚Üí –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
3. **Ctrl+Option+R** (–ø–æ–≤—Ç–æ—Ä–Ω–æ) ‚Üí –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–ø–∏—Å—å
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞** ‚Üí –ê—É–¥–∏–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä—É–µ—Ç—Å—è, —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è —Å–ª–æ–≤–∞-–ø–∞—Ä–∞–∑–∏—Ç—ã
5. **–í—Å—Ç–∞–≤–∫–∞** ‚Üí –¢–µ–∫—Å—Ç –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. [ ] –†–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å Accessibility permissions
2. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –∑–∞–ø–∏—Å—å ‚Üí —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è ‚Üí –≤—Å—Ç–∞–≤–∫–∞
3. [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
4. [ ] –£–ª—É—á—à–∏—Ç—å UI –º–µ–Ω—é-–±–∞—Ä–∞

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ accessibility:
```python
from src.app import check_accessibility_permission
check_accessibility_permission()
```

### –õ–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏:
–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è:
```
üé§ Starting recording...
‚èπ Stopping recording...
Processing X samples (Y.Zs)...
Raw transcription: [—Ç–µ–∫—Å—Ç]
Filtered: [—Ç–µ–∫—Å—Ç]
Inserting: [—Ç–µ–∫—Å—Ç]
‚úì Text inserted successfully
```
